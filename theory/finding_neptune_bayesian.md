# Bayesian Inversion for Planetary Parameter Estimation

This framework provides a complete theoretical foundation for applying Bayesian inversion to the problem of inferring planetary parameters from gravitational perturbations.

## 1. Problem Formulation

The discovery of Neptune in 1846 was guided by mathematical predictions of Uranus's orbital perturbations. The problem can be formulated as an inverse problem: estimating Neptune's parameters from deviations observed in Uranus's trajectory.

Let:

- $m = (m_M, m_x, m_y, m_z, m_{v_x}, m_{v_y}, m_{v_z})$ denote Neptune's parameters, consisting of its mass ($m_M$), position coordinates $(m_x, m_y, m_z)$, and velocity components $(m_{v_x}, m_{v_y}, m_{v_z})$.
- $g(m)$ denote the forward model that predicts Uranus's position at discrete times $t_j$.

Then:

$$g(m) = \begin{bmatrix}
\hat x_1(m) \\
\vdots \\
\hat x_N(m) \\
\hat y_1(m) \\
\vdots \\
\hat y_N(m) \\
\hat z_1(m) \\
\vdots \\
\hat z_N(m)
\end{bmatrix} \in \mathbb{R}^{3N \times 1}$$

and:

$$d = \begin{bmatrix}
x_1 \\
\vdots \\
x_N \\
y_1 \\
\vdots \\
y_N \\
z_1 \\
\vdots \\
z_N
\end{bmatrix} \in \mathbb{R}^{3N \times 1}$$

is the observed trajectory of Uranus.

The inverse problem is posed as the minimization of the data misfit:

$$\min_m \, \| g(m) - d \|_2^2$$

## 2. Gravitational Forward Model

The dynamics of the solar system are modeled using Newton's Law of Universal Gravitation. The net gravitational force on planet $j$ is:

$$\vec{F}_j = \sum_{i=1}^{9} G \frac{m_j m_i}{r_{ji}^2} \, \hat{r}_{ji}$$

where:

- $m_j$ is the mass of planet $j$
- $m_i$ are the masses of other celestial bodies
- $r_{ji}$ is the distance between planets $j$ and $i$
- $\hat{r}_{ji}$ is the unit vector from planet $j$ to planet $i$
- $G$ is the gravitational constant

The system of equations of motion is expressed as:

$$\dot{\mathbf{r}} = \mathbf{v}, \quad \ddot{\mathbf{r}} = \mathbf{a}$$

with:

$$\mathbf{r} = \begin{bmatrix}
\mathbf{r}_1 \\
\vdots \\
\mathbf{r}_9
\end{bmatrix}, \quad \mathbf{a} = \begin{bmatrix}
\mathbf{a}_1 \\
\vdots \\
\mathbf{a}_9
\end{bmatrix}, \quad \mathbf{r}, \mathbf{a} \in \mathbb{R}^{27 \times 1}$$

This leads to the coupled first-order ODE system:

$$\frac{d}{dt} \begin{bmatrix}
\mathbf{r}(t) \\
\mathbf{v}(t)
\end{bmatrix} = \begin{bmatrix}
\mathbf{v}(t) \\
\mathbf{a}(t)
\end{bmatrix}$$

### Runge–Kutta Integration

To solve the above ODE system, one can use the classical fourth-order Runge–Kutta (RK4) method. Given:

$$\dot{f} = g(t, f), \quad f(t_0) = f_0$$

the RK4 update rule is:

$$f_{n+1} = f_n + \frac{h}{6}(k_1 + 2k_2 + 2k_3 + k_4)$$

$$t_{n+1} = t_n + h$$

with:

$$\begin{aligned}
k_1 &= g(t_n, f_n) \\
k_2 &= g\left(t_n + \frac{h}{2}, f_n + \frac{h}{2}k_1\right) \\
k_3 &= g\left(t_n + \frac{h}{2}, f_n + \frac{h}{2}k_2\right) \\
k_4 &= g(t_n + h, f_n + h k_3)
\end{aligned}$$

Here $h$ is the time step size.

Physical quantities are expressed in solar masses (for mass), astronomical units (AU, for distances), and AU/day (for velocities).

## 3. Bayesian Inversion

Bayesian inversion provides a probabilistic framework for inferring model parameters $\mathbf{m}$ from observed data $\mathbf{d}$. By Bayes' theorem:

$$p(\mathbf{m} \mid \mathbf{d}) \propto p(\mathbf{d} \mid \mathbf{m}) \, p(\mathbf{m})$$

where:

- $p(\mathbf{m} \mid \mathbf{d})$ is the posterior distribution
- $p(\mathbf{d} \mid \mathbf{m})$ is the likelihood
- $p(\mathbf{m})$ is the prior

### Likelihood Function

Assuming Gaussian observational errors with covariance matrix $\mathbf{C}_d$, the likelihood is:

$$p(\mathbf{d} \mid \mathbf{m}) = \frac{1}{\sqrt{(2\pi)^n |\mathbf{C}_d|}} \exp\left\{ -\frac{1}{2} \Phi(\mathbf{m}) \right\}$$

where the misfit is defined as:

$$\Phi(\mathbf{m}) = \big[ g(\mathbf{m}) - \mathbf{d} \big]^T \mathbf{C}_d^{-1} \big[ g(\mathbf{m}) - \mathbf{d} \big]$$

## 4. Sampling with the Stretch Move

Exploration of the posterior can be performed using Markov Chain Monte Carlo (MCMC). The stretch move ensemble sampler (Goodman & Weare, 2010) is particularly effective for high-dimensional and correlated parameter spaces.

The method proceeds as follows:

1. Initialize a set of walkers in the parameter space.
2. For each walker, propose a new position based on the positions of other walkers using the stretch move.
3. Accept or reject proposals according to the Metropolis criterion.
4. After a burn-in period, collect samples from all walkers to approximate the posterior distribution.

This approach yields not only the most likely parameter values but also uncertainty estimates and correlations between parameters.

## 5. Synthetic Observations and Noise

To test inversion strategies, synthetic data can be generated by integrating the forward model and adding Gaussian noise. For position components:

$$x_\text{obs} = x + \epsilon_x, \quad y_\text{obs} = y + \epsilon_y, \quad z_\text{obs} = z + \epsilon_z$$

with:

$$\epsilon_x \sim \mathcal{N}(0, \sigma_x^2), \quad \epsilon_y \sim \mathcal{N}(0, \sigma_y^2), \quad \epsilon_z \sim \mathcal{N}(0, \sigma_z^2)$$

Typical noise levels are chosen as:

$$\sigma_x = \sigma_y = 10^{-3}, \quad \sigma_z = 10^{-5}$$

---